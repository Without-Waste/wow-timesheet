<!doctype html>
<html lang="en-NZ">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ffffff" />
  <title>Without Waste Timesheets</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="logo" aria-hidden="true">WW</div>
      <div>
        <h1>Without Waste Timesheets</h1>
        <p class="sub">Offline iPad PWA · One shared device · CSV export</p>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn btn-secondary" id="btnInstallInfo" type="button">Install</button>
      <button class="btn btn-secondary" id="btnBackupHint" type="button">Backup</button>
    </div>
  </header>

  <main class="container">
    <section class="grid">
      <nav class="card">
        <h2>Menu</h2>
        <div class="menu">
          <button class="btn btn-primary" data-view="new" type="button">New shift</button>
          <button class="btn" data-view="history" type="button">History</button>
          <button class="btn" data-view="export" type="button">Export CSV</button>
          <button class="btn btn-danger" data-view="settings" type="button">Settings</button>
        </div>

        <div class="hint">
          <strong>Tip:</strong> Open once online after installing so it can cache for offline use.
        </div>

        <div id="offlineBanner" class="banner" hidden>
          You are offline. Saving still works.
        </div>
      </nav>

      <section class="card view" id="view-new" hidden>
        <h2>New shift</h2>

        <form id="shiftForm" autocomplete="off">
          <div class="row">
            <label>
              Event
              <input id="eventInput" list="eventList" placeholder="Type event name" required />
              <datalist id="eventList"></datalist>
            </label>
            <label>
              Date
              <input id="dateInput" type="date" required />
            </label>
          </div>

          <div class="row">
            <label class="grow">
              Staff name
              <input id="nameInput" list="nameList" placeholder="Type name" required />
              <datalist id="nameList"></datalist>
            </label>
          </div>

          <div class="row">
            <label>
              Start time (editable)
              <input id="startInput" type="datetime-local" />
            </label>
            <label>
              End time (editable)
              <input id="endInput" type="datetime-local" />
            </label>
          </div>

          <div class="actions">
            <button class="btn btn-primary" id="btnStartShift" type="button">Start shift now</button>
          </div>

          <div class="divider"></div>

          <h3>Active shifts</h3>
          <p class="small">Multiple people can be clocked in at the same time. Tap Manage to add breaks or end a shift.</p>
          <div id="activeShiftListHome" class="list"></div>

        </form>
      </section>

      <section class="card view" id="view-active" hidden>
        <h2>Active shift</h2>

        <div class="summary" id="activeSummary"></div>

        <div class="row">
          <label class="grow">
            Break type
            <select id="breakType">
              <option value="10 min">10 min</option>
              <option value="30 min">30 min</option>
              <option value="Meal">Meal</option>
              <option value="Non paid gap">Non paid gap</option>
            </select>
          </label>
          <div class="actions-inline">
            <button class="btn" id="btnStartBreak" type="button">Start break</button>
            <button class="btn" id="btnEndBreak" type="button" disabled>End break</button>
          </div>
        </div>

        <div class="breaks">
          <h3>Breaks</h3>
          <div id="breakList" class="list"></div>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" id="btnEditTimes" type="button">Edit start/end times</button>
          <button class="btn btn-primary" id="btnEndShift" type="button">End shift now and sign</button>
        </div>

        <dialog id="timesDialog">
          <form method="dialog" class="dialog">
            <h3>Edit times</h3>
            <label>
              Start time
              <input id="editStart" type="datetime-local" required />
            </label>
            <label>
              End time
              <input id="editEnd" type="datetime-local" required />
            </label>
            <div class="actions">
              <button class="btn" value="cancel">Cancel</button>
              <button class="btn btn-primary" id="btnSaveTimes" value="ok">Save</button>
            </div>
            <p class="small">Edits are saved locally and will appear in exports.</p>
          </form>
        </dialog>

        <dialog id="breakDialog">
          <form method="dialog" class="dialog">
            <h3>Edit break</h3>
            <label>
              Type
              <select id="editBreakType">
                <option value="10 min">10 min</option>
                <option value="30 min">30 min</option>
                <option value="Meal">Meal</option>
                <option value="Non paid gap">Non paid gap</option>
              </select>
            </label>
            <label>
              Start
              <input id="editBreakStart" type="datetime-local" required />
            </label>
            <label>
              End
              <input id="editBreakEnd" type="datetime-local" required />
            </label>
            <div class="actions">
              <button class="btn" value="cancel">Cancel</button>
              <button class="btn btn-primary" id="btnSaveBreak" value="ok">Save</button>
            </div>
          </form>
        </dialog>
      </section>

      <section class="card view" id="view-sign" hidden>
        <h2>Signature</h2>
        <p class="small">Sign at end of shift. Use finger or Apple Pencil.</p>

        <div class="sig-wrap">
          <canvas id="sigCanvas" width="900" height="320" aria-label="Signature pad"></canvas>
        </div>

        <div class="actions">
          <button class="btn" id="btnClearSig" type="button">Clear</button>
          <button class="btn btn-secondary" id="btnBackToActive" type="button">Back</button>
          <button class="btn btn-primary" id="btnSaveShift" type="button">Save shift</button>
        </div>

        <p class="small">
          Signatures are stored on the iPad. CSV export includes a yes/no field.
        </p>
      </section>

      <section class="card view" id="view-history" hidden>
        <h2>History</h2>
        <div class="row">
          <label class="grow">
            Search
            <input id="historySearch" placeholder="Name or event" />
          </label>
          <label>
            Date
            <input id="historyDate" type="date" />
          </label>
          <button class="btn" id="btnHistoryClearFilters" type="button">Clear</button>
        </div>

        <div id="historyList" class="list"></div>

        <dialog id="detailDialog">
          <form method="dialog" class="dialog">
            <h3>Shift details</h3>
            <div id="detailBody" class="detail"></div>
            <div class="actions">
              <button class="btn" value="close">Close</button>
              <button class="btn btn-danger" id="btnDeleteShift" value="delete">Delete</button>
            </div>
            <p class="small">Delete is permanent on this iPad.</p>
          </form>
        </dialog>
      </section>

      <section class="card view" id="view-export" hidden>
        <h2>Export CSV</h2>
        <p class="small">Exports two CSVs: Shifts and Breaks. Save to Files after download.</p>

        <div class="row">
          <label class="grow">
            Event (optional)
            <input id="exportEvent" list="eventList" placeholder="Leave blank for all events" />
          </label>
        </div>

        <div class="row">
          <label>
            From
            <input id="exportFrom" type="date" />
          </label>
          <label>
            To
            <input id="exportTo" type="date" />
          </label>
        </div>

        <div class="actions">
          <button class="btn btn-primary" id="btnExportShifts" type="button">Export Shifts.csv</button>
          <button class="btn btn-primary" id="btnExportBreaks" type="button">Export Breaks.csv</button>
        </div>

        <div class="divider"></div>
        <div class="note">
          <strong>Backup habit:</strong> export after each event. Offline apps are great until an iPad breaks.
        </div>
      </section>

      <section class="card view" id="view-settings" hidden>
        <h2>Settings</h2>
        <p class="small">Danger zone.</p>
        <div class="actions">
          <button class="btn btn-danger" id="btnWipeAll" type="button">Delete all data on this iPad</button>
        </div>
      </section>
    </section>
  </main>

  <footer class="footer">
    <span id="statusText">Ready</span>
  </footer>

  <script src="app.js"></script>
</body>
</html>
