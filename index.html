<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WOW Staff Timesheet</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="light">
  <header class="header">
    <div class="brand">WOW</div>
    <h1>WOW Staff Timesheet</h1>
    <p class="muted">One shared device. Multiple active shifts. Signature at end. Export one CSV.</p>

    <nav class="tabs" aria-label="Views">
      <button class="tab active" id="tabActive" type="button">Active</button>
      <button class="tab" id="tabHistory" type="button">History</button>
      <button class="tab" id="tabExport" type="button">Export</button>
    </nav>
  </header>

  <main class="container">
    <!-- ACTIVE VIEW -->
    <section id="viewActive">
      <section class="card">
        <h2>Start a new shift</h2>

        <div class="grid">
          <label class="field">
            <span>Event name</span>
            <input id="eventName" placeholder="e.g. Sparks in the Park" autocomplete="off">
          </label>

          <label class="field">
            <span>Staff name</span>
            <input id="staffName" placeholder="e.g. Kate" autocomplete="off">
          </label>

          <label class="field">
            <span>Date</span>
            <input id="shiftDate" type="date">
          </label>

          <label class="field">
            <span>Start time</span>
            <input id="shiftStart" type="time">
          </label>
        </div>

        <div class="actions">
          <button id="startShift" class="btn primary" type="button">Start shift</button>
          <button id="clearInputs" class="btn" type="button">Clear</button>
        </div>

        <p class="hint">Start time defaults to now. You can edit it before starting.</p>
      </section>

      <section class="card">
        <div class="row">
          <h2>Active shifts</h2>
          <span id="activeCount" class="pill">0</span>
        </div>
        <div id="activeShifts" class="stack"></div>
        <p id="noActive" class="muted">No active shifts yet.</p>
      </section>
    </section>

    <!-- HISTORY VIEW -->
    <section id="viewHistory" hidden>
      <section class="card">
        <div class="row">
          <h2>History</h2>
          <span id="historyCount" class="pill">0</span>
        </div>

        <div class="grid export-grid">
          <label class="field">
            <span>Search (name or event)</span>
            <input id="historySearch" placeholder="type to filter">
          </label>
          <label class="field">
            <span>Date (optional)</span>
            <input id="historyDate" type="date">
          </label>
          <div class="actions" style="align-self:end; margin:0">
            <button id="historyClear" class="btn" type="button">Clear filters</button>
          </div>
        </div>

        <div id="historyList" class="stack" style="margin-top:14px"></div>
        <p id="noHistory" class="muted">No completed shifts yet.</p>
      </section>
    </section>

    <!-- EXPORT VIEW -->
    <section id="viewExport" hidden>
      <section class="card">
        <h2>Export</h2>
        <div class="grid export-grid">
          <label class="field">
            <span>Event filter (optional)</span>
            <input id="exportEvent" placeholder="leave blank for all">
          </label>
          <label class="field">
            <span>From (optional)</span>
            <input id="exportFrom" type="date">
          </label>
          <label class="field">
            <span>To (optional)</span>
            <input id="exportTo" type="date">
          </label>
        </div>
        <div class="actions">
          <button id="exportCSV" class="btn primary" type="button">Export Timesheets.csv</button>
        </div>
        <p class="hint">Export includes completed shifts only. Signatures are included as Yes or No (image stays on device).</p>
      </section>
    </section>
  </main>

  <footer class="footer muted">
    <small>Data is stored on this device only. Export after each event.</small>
  </footer>

  <!-- SIGNATURE MODAL -->
  <dialog id="sigDialog" class="modal">
    <form method="dialog" class="modalBody">
      <h3 style="margin:0 0 8px">Signature</h3>
      <p class="muted" style="margin:0 0 12px">Have the staff member sign below, then Save.</p>
      <div class="sigWrap">
        <canvas id="sigCanvas" width="900" height="260"></canvas>
      </div>
      <div class="actions">
        <button id="sigClear" class="btn" value="noop" type="button">Clear</button>
        <button id="sigCancel" class="btn" value="cancel" type="submit">Cancel</button>
        <button id="sigSave" class="btn primary" value="save" type="submit">Save signature</button>
      </div>
      <p class="hint">Tip: use a finger or Apple Pencil. If you really cannot sign, Cancel and weâ€™ll save without it.</p>
    </form>
  </dialog>

  <!-- HISTORY DETAIL MODAL -->
  <dialog id="detailDialog" class="modal">
    <form method="dialog" class="modalBody">
      <h3 style="margin:0 0 8px">Shift details</h3>
      <div id="detailBody" class="detail"></div>
      <div class="actions">
        <button class="btn" value="close" type="submit">Close</button>
        <button id="detailDelete" class="btn danger" value="delete" type="submit">Delete shift</button>
      </div>
      <p class="hint">Deleting removes this shift from history and export. This cannot be undone.</p>
    </form>
  </dialog>

  <script src="app.js"></script>
</body>
</html>
